var urlManager = {
  urlPathArray: [],
  urlPathCount: 0,
  urlDir: null,
  pageTitle: null,
  locales: redirectManager.locales,
  current_cookie: cookieManager.getCookie('ss_geo_redir'),
  context: function(){
    this.readPath();
    var locales = this.locales;
    switch(true){
      case this.urlPathCount == 2 && !this.urlPathArray[1]:
        this.urlDir = 'global-index';
        break;

      case this.urlPathCount == 3 && this.urlPathArray[1].length > 2:
        this.urlDir = 'global-content';
        break;

      case this.urlPathCount == 3 && this.urlPathArray[1].length == 2 && locales.indexOf(this.urlPathArray[1]) > -1:
        this.urlDir = 'region-index';
        break;

      case this.urlPathCount == 4 && this.urlPathArray[1].length == 2 && locales.indexOf(this.urlPathArray[1]) > -1:
        this.urlDir = this.contentPathCheck();
        break;

      default:
        this.urlDir = 'global-index';
        break;
    }
    return this.urlDir;
  },
  readPath: function(){
    this.urlPathArray = window.location.pathname.split('/');
    this.urlPathCount = this.urlPathArray.length;
  },
  contentPathCheck: function(){
    return this.urlPathArray[1].length == 2 ? 'region-content' : 'global-content';
  },
  getPageTitle: function(context){
    this.readPath();
    if(context === 'region-content'){
      return this.pageTitle = this.urlPathArray[1];
    } else {
      return this.pageTitle = this.urlPathArray[2];
    }
  },
  updateLogoUrl: function(){
    var current_cookie = this.current_cookie;
    var site_logo = document.getElementById('site_logo');
    if(site_logo !== null){
      this.locales.forEach(function(item){
        site_logo.setAttribute('href', geoCleaner.tidyRegionPath(current_cookie));
      });
    }
  },
  updateSpecificPageUrls: function(){
    var page_ids = ['site_logo'];
    var current_cookie = this.current_cookie;
    var page404 = document.getElementById('_404');
    var footer = document.getElementById('main-menu');
    var privacy_url = document.getElementById('privacy_url');
    var privacy_url_page = privacy_url.href.split('/').length-1;
    var external_url = document.getElementById('external_url');
    var external_url_mobile = document.getElementById('external_url_mobile');
    var sharesight_url = document.getElementById('sharesight_url');
    if(page404 !== null && footer !== null){
      external_url.setAttribute('href', 'https://www.sharesight.com'+geoCleaner.tidyRegionPath(current_cookie));
      external_url_mobile.setAttribute('href', 'https://www.sharesight.com'+geoCleaner.tidyRegionPath(current_cookie));
      privacy_url.setAttribute('href', 'https://www.sharesight.com'+geoCleaner.tidyRegionPath(current_cookie)+privacy_url.href.split('/')[privacy_url_page-1]+'/');

      var page404_links = page404.getElementsByTagName('a');

      if(page404_links !== null && page404_links.length > 0){
        if(page404_links[0].innerText === 'homepage'){
          page404_links[0].setAttribute('href', geoCleaner.tidyRegionPath(current_cookie));
        }
      }
    }
    if(footer !== null){
      var footer_links = footer.getElementsByTagName('a');
      if(footer_links[0].innerText.replace(/\s/g,'') === 'www.sharesight.com'){
        footer_links[0].setAttribute('href', 'https://www.sharesight.com'+geoCleaner.tidyRegionPath(current_cookie));
      }
      if(footer_links[0].innerText === 'Privacy Policy'){
        footer_links[0].setAttribute('href', 'https://www.sharesight.com'+geoCleaner.tidyRegionPath(current_cookie));
      }
    }

  },
  updateSelector: function(){
    var current_cookie = this.current_cookie;
    var selector = document.getElementById('region_selector');
    if(selector !== null){
      for(var i=0; i < selector.options.length; i++){
        selector.options[i].removeAttribute('selected');
        if(geoCleaner.cleanGeoCode(selector.options[i].value) === current_cookie.toLowerCase()){
          selector.options[i].setAttribute('selected', true);
        } else if(selector.options[i].value == current_cookie.toLowerCase()) {
          selector.options[i].setAttribute('selected', true);
        }
      }
    }
  },
  getLastPathInUrl: function(link){
    return link.href.split('/').length-1;
  },
  modifyElementUrl: function(obj){
    var current_cookie = this.current_cookie;
    if(obj !== null){
      return obj.setAttribute('href', geoCleaner.tidyRegionPath(current_cookie)+obj.href.split('/')[this.getLastPathInUrl(obj)]);
    }
  }
}
